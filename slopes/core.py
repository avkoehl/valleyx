def extract_valleys(dem, flowlines, wbt, params):
    # full workflow
    pass
